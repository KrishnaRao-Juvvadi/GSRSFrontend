<div *ngIf="substance">
  <div class='float-right'>
    <button mat-icon-button [matMenuTriggerFor]="optionMenu">
      <mat-icon svgIcon="menu">menu</mat-icon>
    </button>
    <mat-menu #optionMenu="matMenu" xPosition="before">
      <a mat-menu-item [routerLink]="['/substances', substance.uuid, 'edit']" *ngIf="auth.hasRoles('admin')">
        <mat-icon svgIcon="edit"></mat-icon>
        <span>Edit</span>
      </a>
      <a mat-menu-item [href]="downloadJsonHref" download="results.json">
        <mat-icon svgIcon="get_app"></mat-icon>
        <span>Download JSON</span>
      </a>
    </mat-menu>
  </div>
  <div>
    <div class="name-value">
      <div class="name">Substance Class</div>
      <div class="value blue-font">{{substance.substanceClass}}</div>
    </div>
    <div class="name-value">
      <div class="name">Record UNII</div>
      <div class="value blue-font">{{substance._approvalIDDisplay}}</div>
    </div>
    <div class="name-value">
      <div class="name">Record Status</div>
      <div class="value blue-font">{{substance.status === 'approved' ? 'Validated (UNII)' : 'pending'}}</div>
    </div>
    <div class="name-value">
      <div class="name">Record Version</div>
      <div class="value blue-font">{{substance.version}}</div>
    </div>
    <div *ngIf="substance.structurallyDiverse" class="diverseWrapper">
      <div class="name-value" *ngIf="substance.structurallyDiverse.sourceMaterialClass">
        <div class="name">Source Materials Class</div>
        <div class="value blue-font">{{substance.structurallyDiverse.sourceMaterialClass}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.sourceMaterialType">
        <div class="name">Source Materials Type</div>
        <div class="value blue-font">{{substance.structurallyDiverse.sourceMaterialType}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.sourceMaterialState">
        <div class="name">Source Materials State</div>
        <div class="value blue-font">{{substance.structurallyDiverse.sourceMaterialState}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.parentSubstance">
        <div class="name">Source Materials Parent</div>
        <div class="thumb-col">
          <img class="image-thumb"
            [src]="getSafeStructureImgUrl(substance.structurallyDiverse.parentSubstance.refuuid)">
          <div>
            <a class="substance-name"
              [routerLink]="['/substances', substance.structurallyDiverse.parentSubstance.refuuid]">
              {{substance.structurallyDiverse.parentSubstance.refPname}}
            </a>
          </div>
        </div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.organismFamily">
        <div class="name">Organism Family</div>
        <div class="value blue-font">{{substance.structurallyDiverse.organismFamily}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.organismGenus">
        <div class="name">Organism Genus</div>
        <div class="value blue-font">{{substance.structurallyDiverse.organismGenus}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.organismSpecies">
        <div class="name">Organism Species</div>
        <div class="value blue-font">{{substance.structurallyDiverse.organismSpecies}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.organismAuthor">
        <div class="name">Organism Author</div>
        <div class="value blue-font">{{substance.structurallyDiverse.organismAuthor}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.developmentalStage">
        <div class="name">Developmental Stage</div>
        <div class="value blue-font">{{substance.structurallyDiverse.developmentalStage}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.part?.length > 0">
        <div class="name">Part</div>
        <div class="value blue-font">
          <span *ngFor="let part of substance.structurallyDiverse.part; last as isLast">
            {{part}}<span *ngIf="!isLast">, </span>
          </span></div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.fractionMaterialType">
        <div class="name">Fraction Materials Type</div>
        <div class="value blue-font">{{substance.structurallyDiverse.fractionMaterialType}}</div>
      </div>
      <div class="name-value" *ngIf="substance.structurallyDiverse.fractionName">
        <div class="name">Fraction Name</div>
        <div class="value blue-font">{{substance.structurallyDiverse.fractionName}}</div>
      </div>

    </div>
    <div class="name-value" *ngIf="references?.length > 0">
      <div class="name">
        <a (click)="toggleReferences()" class='blue-font references-link'>
          <span>{{showDef === false ? 'Show' : 'Hide'}} Definitional References</span>
          <mat-icon svgIcon="{{defIcon}}"></mat-icon>
        </a>
      </div>
    </div>


    <div [hidden]="!showDef">
      <app-references-manager [substance]="substance" [references]="references"></app-references-manager>
    </div>
  </div>



</div>