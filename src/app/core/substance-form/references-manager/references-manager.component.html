<div class="reference-form-container" *ngFor="let reference of references; last as isLast">
  <div class="form-row">
    <mat-form-field class="source-type">
      <mat-label>Source Type *</mat-label>
      <mat-select [formControl]="reference.documentTypeControl">
        <mat-option *ngFor="let documentType of documentTypes" [value]="documentType.value">
          {{documentType.display}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field class="citation">
      <input matInput placeholder="Source Text/Citation *" [formControl]="reference.citationControl"/>
    </mat-form-field>
    <div>
      <mat-checkbox [formControl]="reference.publicDomainControl">Public Domain</mat-checkbox>
    </div>
    <div>
      <app-access-manager (accessOut)="reference.updateAccess($event)" [accessIn]="reference.accessEmitter"></app-access-manager>
    </div>
  </div>
  <div class="form-row">
    <mat-form-field class="url">
      <input matInput placeholder="URL" [formControl]="reference.urlControl"/>
    </mat-form-field>
    <mat-form-field>
      <input matInput placeholder="Source Id" [formControl]="reference.idControl"/>
    </mat-form-field>
    <mat-form-field class="tags">
      <mat-chip-list #chipList aria-label="Fruit selection">
        <mat-chip
          *ngFor="let tag of reference.tags"
          selectable="true"
          removable="true"
          (removed)="reference.removeTag(tag)">
          {{documentCollectionsDictionary[tag].display}}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
        <input
          disabled="true"
          placeholder="Tags"
          #tagInput
          [matAutocomplete]="auto"
          [matChipInputFor]="chipList"
          [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
          matChipInputAddOnBlur="false">
      </mat-chip-list>
      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="reference.tagSelected($event)">
        <mat-option *ngFor="let documentCollection of documentCollections" [value]="documentCollection.value">
          {{documentCollection.display}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    
  </div>
  <mat-divider class="form-divider" [inset]="true" *ngIf="!isLast"></mat-divider>
</div>