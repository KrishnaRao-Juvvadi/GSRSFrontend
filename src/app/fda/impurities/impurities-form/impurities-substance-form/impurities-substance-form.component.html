<div *ngIf="impuritiesSubstanceIndex > 0">
  <br>
  <hr>
  <br>
</div>
<div class="divflexrow">
  <div class="form-row">
    <div class="col-4-1">
      <app-substance-selector class="textaligncenter" (selectionUpdated)="relatedSubstanceUpdated($event)"
        eventCategory="substanceRelationshipRelatedSub" placeholder="Substance Name" [hideImage]="false"
        header="Substance Name" [subuuid]="impuritiesSubstance.substanceUuid">
      </app-substance-selector>
      <div class="textaligncenter font11px" *ngIf="impuritiesSubstance.relatedSubstanceUnii">{{impuritiesSubstance.relatedSubstanceUnii}}</div>
    </div>

    <mat-form-field class="col-4-1">
      <input matInput placeholder="Assay Low" [(ngModel)]="impuritiesSubstance.low" name="low" />
    </mat-form-field>

    <mat-form-field class="col-4-1">
      <input matInput placeholder="Assay High" [(ngModel)]="impuritiesSubstance.high" name="high" />
    </mat-form-field>

    <app-cv-input class="col-4-1" domain="PROD_UNIT" title="Unit" name="unit" [model]="impuritiesSubstance.unit"
      (valueChange)="impuritiesSubstance.unit = $event">
    </app-cv-input>
  </div>

  <!-- Add and Delete Impurities Substance Button -->
  <!--
      <span class="width40px displayinlineblock">
        <button mat-icon-button color="primary" *ngIf="impuritiesSubstanceIndex == 0"
          (click)="addNewImpuritiesSubstance()" matTooltip="Add New Substance Name">
          <mat-icon>add_circle_outline</mat-icon>
        </button>
      </span>
    -->
  <button mat-icon-button color="primary" (click)="confirmDeleteImpuritiesSubstance()"
    matTooltip="Delete Substance Name">
    <mat-icon>delete_forever</mat-icon>
  </button>

</div>
<br>

<!-- IMPURITIES TEST LIST BEGIN -->
<mat-card class="margintop20px bordergray">
  <mat-card-title class="titleblue">
    <div class="divflex titleblue">
      <div matBadge="{{impuritiesSubstance.impuritiesTestList.length}}" matBadgeColor="accent" matBadgeSize="medium"
        matBadgeOverlap="false">
        <span class="titleblue"><b>Test</b></span>
      </div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <div>
        <button mat-raised-button color="primary" (click)="addNewTest()" matTooltip="Add New Test">
          <mat-icon svgIcon="add_circle_outline"></mat-icon>Add Test
        </button>
      </div>
      <div class="width200px marginleft20px">
        <button mat-raised-button color="primary" (click)="getExistingImpuritiesFromSubstance()"
          matTooltip="Get Impurities for Substance">
          Get Existing Impurities from Substance
        </button>
        <div *ngIf="errorMessage" class="">
          <span class="colorred font13px">
            {{errorMessage}}
          </span>
        </div>
      </div>
    </div>
  </mat-card-title>
  <mat-card-content>
    <div class="marginbottom10px"
      *ngFor="let impuritiesTest of impuritiesSubstance.impuritiesTestList; let impuritiesTestIndex = index">
      <app-impurities-test-form [impuritiesTest]="impuritiesTest" [impuritiesTestIndex]="impuritiesTestIndex"
        [impuritiesSubstanceIndex]="impuritiesSubstanceIndex">
      </app-impurities-test-form>
    </div>
    <!-- Loop -->

  </mat-card-content>
</mat-card>
<!-- IMPURITIES TEST LIST END -->



<!-- IMPURITIES RESIDUAL SOLVENT LIST BEGIN -->
<br><br><br>
<div class="divflex margintop50px">
  <div class="titleblue">
    <span matBadge="{{impuritiesSubstance.impuritiesResidualSolventsList.length}}" matBadgeColor="accent"
      matBadgeSize="medium" matBadgeOverlap="false">
      <span class="titleblue"><b>Residual Solvents</b></span>
    </span>
    
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button mat-raised-button color="primary" (click)="addNewImpuritiesResidualSolvents()"
      matTooltip="Add New Residual Solvent">
      <mat-icon svgIcon="add_circle_outline"></mat-icon>Add Residual Solvents
    </button>
  </div>
</div>

<div class="marginbottom10px"
  *ngFor="let impuritiesResidualSolvents of impuritiesSubstance.impuritiesResidualSolventsList; let impuritiesResidualIndex = index">
  <app-impurities-residual-solvents-form [impuritiesResidualSolvents]="impuritiesResidualSolvents"
    [impuritiesResidualIndex]="impuritiesResidualIndex" [impuritiesSubstanceIndex]="impuritiesSubstanceIndex">
  </app-impurities-residual-solvents-form>
</div>
<!-- IMPURITIES RESIDUAL SOLVENT LIST END -->


<!-- IMPURITIES ORGANICE LIST BEGIN -->
<br><br><br>
<div class="divflex margintop50px">
  <div class="titleblue">
    <span matBadge="{{impuritiesSubstance.impuritiesInorganicList.length}}" matBadgeColor="accent" matBadgeSize="medium"
      matBadgeOverlap="false">
      <span class="titleblue"><b>Inorganic Impurities</b></span>
    </span>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button mat-raised-button color="primary" (click)="addNewImpuritiesInorganic()" matTooltip="Add New Inorganic">
      <mat-icon svgIcon="add_circle_outline"></mat-icon>Add Impurities Inorganic
    </button>
  </div>
</div>

<div class="marginbottom10px"
  *ngFor="let impuritiesInorganic of impuritiesSubstance.impuritiesInorganicList; let impuritiesInorganicIndex = index">
  <app-impurities-inorganic-form [impuritiesInorganic]="impuritiesInorganic"
    [impuritiesInorganicIndex]="impuritiesInorganicIndex" [impuritiesSubstanceIndex]="impuritiesSubstanceIndex">
  </app-impurities-inorganic-form>
</div>
<!-- IMPURITIES INORGANIC LIST END -->
      
