<div class="info-container">
  <a *ngIf="substance && substance.uuid" [href]="baseDomain + '/ginas/app/substance/' + substance.uuid + '#fdadetails'"
    target="_blank">
    For data export, sorting and searching of the tabs below please use the classic view here
  </a>
</div>
<div class="bordergray mat-tab-style">
  <mat-tab-group>


    <mat-tab label="Product ({{productCount}})">

      <div *ngIf="(loadingComplete === true && foundProvenanceList === false && productCount === 0)">
        <br>
        <div class="padleft25px colorblue"><b>No Product Found</b></div>
        <br>
      </div>

      <mat-tab-group (selectedTabChange)="tabSelected($event)">
        <mat-tab label="{{prov}}" *ngFor="let prov of provenanceList; let index = index">

          <div class="padtop5px padleft25px font15px colorblue">
            <b> {{prov}}</b>
            &nbsp;&nbsp;&nbsp;
            <span class="colorred">{{loadingStatus}}</span>
            &nbsp;&nbsp;&nbsp;
            <a [href]="exportUrl" target="_blank" matTooltip='Product Records' *ngIf="totalRecords > 0">
              <button mat-icon-button color="primary">
                <mat-icon>arrow_downward</mat-icon>Export All Products
              </button>
            </a>
          </div>

          <div class="responsive mat-table-style">

            <div *ngIf="showSpinner" class="spinnerstyle">
              <mat-progress-spinner diameter="80" color="warn" mode="indeterminate">
              </mat-progress-spinner>
            </div>

            <table mat-table [dataSource]="paged" class="font12px">

              <ng-container matColumnDef="productNDC">
                <th mat-header-cell *matHeaderCellDef> Product NDC </th>
                <td mat-cell *matCellDef="let product">
                  <span *ngIf="product.fromtable === 'GSRS'">
                    <a [routerLink]="['/productDetails', product.productId, 'srs']" target="_blank">
                      <span *ngIf="product.productNDC; else noProdNDCGSRS">
                        {{product.productNDC}}
                      </span>
                      <ng-template #noProdNDCGSRS>
                        (NO NDC)
                      </ng-template>
                    </a>
                    &nbsp;&nbsp;
                    <a [routerLink]="['/product', product.productId, 'edit']" target="_blank" *ngIf="isAdmin"
                      matTooltip='Edit GSRS Product Record'>
                      <mat-icon svgIcon="edit"></mat-icon>
                    </a>
                  </span>
                  <span *ngIf="product.fromtable != 'GSRS'">
                    <a [routerLink]="['/productElistDetails', product.productId,'elist']" target="_blank">
                      <span *ngIf="product.productNDC; else noProdNDC">
                        {{product.productNDC}}
                      </span>
                      <ng-template #noProdNDC>
                        (NO NDC)
                      </ng-template>
                    </a>
                    <br><span class="font10px colorgray">({{product.fromtable}})</span>
                  </span>
                </td>
              </ng-container>

              <ng-container matColumnDef="productName">
                <th mat-header-cell *matHeaderCellDef> Product Name </th>
                <td mat-cell *matCellDef="let product"> {{product.productName}} </td>
              </ng-container>

              <ng-container matColumnDef="labelerName">
                <th mat-header-cell *matHeaderCellDef> Labeler Name </th>
                <td mat-cell *matCellDef="let product"> {{product.labelerName}} </td>
              </ng-container>

              <ng-container matColumnDef="country">
                <th mat-header-cell *matHeaderCellDef> Country </th>
                <td mat-cell *matCellDef="let product"> {{product.country}} </td>
              </ng-container>

              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef> Status </th>
                <td mat-cell *matCellDef="let product"> {{product.status}} </td>
              </ng-container>

              <ng-container matColumnDef="productNameType">
                <th mat-header-cell *matHeaderCellDef> Product Type </th>
                <td mat-cell *matCellDef="let product"> {{product.productType}} </td>
              </ng-container>

              <ng-container matColumnDef="activeMoiety">
                <th mat-header-cell *matHeaderCellDef> Active Moiety </th>
                <td mat-cell *matCellDef="let product"> {{product.activeMoietyName}} </td>
              </ng-container>

              <ng-container matColumnDef="ingredientType">
                <th mat-header-cell *matHeaderCellDef> Ingredient Type </th>
                <td mat-cell *matCellDef="let product"> {{product.ingredientType}} </td>
              </ng-container>

              <ng-container matColumnDef="applicationNumber">
                <th mat-header-cell *matHeaderCellDef> Application Number </th>
                <td mat-cell *matCellDef="let product"> {{product.appTypeNumber}} </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
          </div>
          <mat-paginator [length]="totalRecords" [pageSize]="5" showFirstLastButtons="true"
            (page)="getSubstanceProducts($event)" [pageSizeOptions]="[5, 10, 25, 100]">
          </mat-paginator>
        </mat-tab>


      </mat-tab-group>

      <!--
      </div>
      <ng-template #noprovence>
        <br>
        <div class="padleft25px colorblue"><b>No Product Found</b></div>
        <br>
      </ng-template>
    -->
    </mat-tab>

    <!--  PREVIOUS CODE
      <div class="responsive mat-table-style">
        <table mat-table [dataSource]="paged">

          <ng-container matColumnDef="productNDC">
            <th mat-header-cell *matHeaderCellDef> Product NDC </th>
            <td mat-cell *matCellDef="let product">
              <div *ngIf="product.fromTable === 'SRS'">
                <a [routerLink]="['/productDetails', product.id, 'srs']" target="_blank">{{product.productNDC}}</a>
              </div>
              <div *ngIf="product.fromTable != 'SRS'">
                <a [routerLink]="['/productElistDetails', product.id, 'elist']"
                  target="_blank">{{product.productNDC}}</a>
                <br><span class="font10px colorgray">(Elist)</span>
              </div>

            </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> Product Name </th>
            <td mat-cell *matCellDef="let product"> {{product.productName}} </td>
          </ng-container>

          <ng-container matColumnDef="nonProprietaryName">
            <th mat-header-cell *matHeaderCellDef> Non Proprietary Name </th>
            <td mat-cell *matCellDef="let product"> {{product.nonProprietaryName}} </td>
          </ng-container>

          <ng-container matColumnDef="labelerName">
            <th mat-header-cell *matHeaderCellDef> Labeler Name </th>
            <td mat-cell *matCellDef="let product"> {{product.labelerName}} </td>
          </ng-container>

          <ng-container matColumnDef="applicationNumber">
            <th mat-header-cell *matHeaderCellDef> Application Number </th>
            <td mat-cell *matCellDef="let product"> {{product.applicationNumber}} </td>
          </ng-container>

          <ng-container matColumnDef="productNameType">
            <th mat-header-cell *matHeaderCellDef> Product Name Type </th>
            <td mat-cell *matCellDef="let product"> {{product.productTypeName}} </td>
          </ng-container>

          <ng-container matColumnDef="ingredientType">
            <th mat-header-cell *matHeaderCellDef> Ingredient Type </th>
            <td mat-cell *matCellDef="let product"> {{product.ingredientType}} </td>
          </ng-container>
       

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    
      <mat-paginator [length]="totalRecords" [pageSize]="5" showFirstLastButtons="true"
        (page)="getSubstanceProducts($event)" [pageSizeOptions]="[5, 10, 25, 100]">
      </mat-paginator>
    -->


    <mat-tab label="Application ({{applicationCount}})">
      <app-substance-application [bdnum]="bdnum" (countApplicationOut)="getApplicationCount($event)">
      </app-substance-application>
    </mat-tab>

    <div>
      <mat-tab label="Clinical Trial ({{clinicalTrialCount}})">
        <app-substance-clinical-trials [bdnum]="bdnum" (countClinicalTrialOut)="getClinicalTrialCount($event)">
        </app-substance-clinical-trials>
      </mat-tab>
    </div>

    <mat-tab label="Clinical Trial Europe ({{clinicalTrialEuCount}})">
      <app-substance-clinical-trials-eu [bdnum]="bdnum" (countClinicalTrialEuOut)="getClinicalTrialEuCount($event)">
      </app-substance-clinical-trials-eu>
    </mat-tab>

    <mat-tab label="Adverse Event PT ({{advPtCount}})">
      <app-substance-adverseeventpt [bdnum]="bdnum" [substanceName]="substanceName" (countAdvPtOut)="getAdvPtCount($event)">
      </app-substance-adverseeventpt>
    </mat-tab>

    <mat-tab label="Adverse Event DME ({{advDmeCount}})">
      <app-substance-adverseeventdme [bdnum]="bdnum" (countAdvDmeOut)="getAdvDmeCount($event)">
      </app-substance-adverseeventdme>
    </mat-tab>

    <mat-tab label="Adverse Event CVM ({{advCvmCount}})">
      <app-substance-adverseeventcvm [bdnum]="bdnum" (countAdvCvmOut)="getAdvCvmCount($event)">
      </app-substance-adverseeventcvm>
    </mat-tab>

    <mat-tab label="Impurities Specs ({{impuritiesCount}})">
      <app-substance-impurities [substanceUuid]="substance.uuid" (countImpuritiesOut)="getImpuritiesCount($event)">
      </app-substance-impurities>
    </mat-tab>
    
  </mat-tab-group>
</div>